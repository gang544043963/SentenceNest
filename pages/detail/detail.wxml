<!--pages/detail/detail.wxml-->
<view class="container">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <view class="custom-navbar">
    <view class="navbar-left" bindtap="goBack">
      <text class="back-icon">â€¹</text>
      <text class="back-text">è¿”å›</text>
    </view>
    
    <view class="navbar-center">
      <text class="navbar-title">å¥å­è¯¦æƒ…</text>
    </view>
    
    <view class="navbar-right">
      <button 
        class="collect-nav-btn {{isCollected ? 'collected' : ''}}" 
        bindtap="toggleCollection"
        wx:if="{{!loading}}"
      >
        <text class="collect-icon">{{isCollected ? 'â¤ï¸' : 'ğŸ¤'}}</text>
      </button>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½è¯¦æƒ…ä¸­...</text>
  </view>

  <!-- å¥å­è¯¦æƒ… -->
  <view wx:else class="detail-content">
    <!-- å¥å­å¡ç‰‡ -->
    <view class="sentence-detail-card card fade-in">
      <view class="sentence-content">
        <text class="english-text">{{sentence.content}}</text>
        <text class="chinese-text">{{sentence.translation}}</text>
      </view>
      
      <!-- æœ—è¯»æŒ‰é’® -->
      <view class="play-section">
        <button 
          class="play-detail-btn {{isPlaying ? 'playing' : ''}}" 
          bindtap="playAudio"
          disabled="{{isPlaying}}"
        >
          <text class="play-icon">{{isPlaying ? 'ğŸ”Š' : 'ğŸ”Š'}}</text>
          <text class="play-text">{{isPlaying ? 'æ­£åœ¨æ’­æ”¾...' : 'ç‚¹å‡»æœ—è¯»'}}</text>
        </button>
      </view>
    </view>

    <!-- é‡ç‚¹è¯æ±‡è¯¦æƒ… -->
    <view wx:if="{{sentence.keywords}}" class="keywords-detail-section card fade-in">
      <view class="section-header">
        <text class="section-title">é‡ç‚¹è¯æ±‡è§£æ</text>
        <text class="keywords-count">å…± {{sentence.keywords.length}} ä¸ª</text>
      </view>
      
      <view class="keywords-detail-list">
        <view 
          wx:for="{{sentence.keywords}}" 
          wx:key="word" 
          class="keyword-detail-item"
        >
          <view class="keyword-header">
            <view class="word-info">
              <text class="word-main">{{item.word}}</text>
              <text class="word-phonetic">{{item.phonetic}}</text>
            </view>
            <view class="word-pos">
              <text class="pos-tag">{{item.partOfSpeech}}</text>
            </view>
          </view>
          
          <view class="word-meaning">
            <text class="meaning-text">{{item.meaning}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- å¥å­ä¿¡æ¯ -->
    <view class="sentence-info card fade-in">
      <view class="info-header">
        <text class="info-title">å¥å­ä¿¡æ¯</text>
      </view>
      
      <view class="info-list">
        <view class="info-item">
          <text class="info-label">æ—¥æœŸ</text>
          <text class="info-value">{{sentence.date || 'ä»Šæ—¥'}}</text>
        </view>
        
        <view class="info-item" wx:if="{{sentence.collectedAt}}">
          <text class="info-label">æ”¶è—æ—¶é—´</text>
          <text class="info-value">{{sentence.collectedAt.split('T')[0]}}</text>
        </view>
        
        <view class="info-item">
          <text class="info-label">è¯æ±‡æ•°é‡</text>
          <text class="info-value">{{sentence.keywords ? sentence.keywords.length : 0}} ä¸ªé‡ç‚¹è¯æ±‡</text>
        </view>
      </view>
    </view>

    <!-- æ“ä½œæç¤º -->
    <view class="action-tips">
      <text class="tip-text">ğŸ’¡ æ¯å¤©åšæŒå­¦ä¹ ä¸€å¥è‹±è¯­ï¼Œç§¯å°‘æˆå¤š</text>
    </view>
  </view>
</view>