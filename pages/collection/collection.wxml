<!--pages/collection/collection.wxml-->
<view class="container">
  <!-- æœªç™»å½•çŠ¶æ€ -->
  <view wx:if="{{!isLoggedIn}}" class="login-prompt">
    <view class="login-icon">ğŸ”</view>
    <text class="login-title">éœ€è¦ç™»å½•</text>
    <text class="login-desc">ç™»å½•åå¯ä»¥æŸ¥çœ‹å’Œç®¡ç†ä½ çš„æ”¶è—</text>
    <view class="login-btn" bindtap="userLogin">
      <text>ç«‹å³ç™»å½•</text>
    </view>
  </view>

  <!-- å·²ç™»å½•çŠ¶æ€ -->
  <view wx:else>
    <!-- æœç´¢æ  -->
    <view class="search-bar">
      <view class="search-input-wrapper">
        <input 
          class="search-input" 
          placeholder="æœç´¢æ”¶è—çš„å¥å­..."
          value="{{searchValue}}"
          bindinput="onSearchInput"
          confirm-type="search"
        />
        <view wx:if="{{searchValue}}" class="clear-btn" bindtap="clearSearch">
          <text class="clear-icon">Ã—</text>
        </view>
        <view class="search-icon">ğŸ”</view>
      </view>
    </view>

    <!-- åŠ è½½çŠ¶æ€ -->
    <view wx:if="{{loading}}" class="loading-container">
      <view class="loading-spinner"></view>
      <text class="loading-text">åŠ è½½æ”¶è—ä¸­...</text>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:elif="{{isEmpty}}" class="empty-container">
      <view class="empty-icon">ğŸ“š</view>
      <text class="empty-title">è¿˜æ²¡æœ‰æ”¶è—</text>
      <text class="empty-desc">å»é¦–é¡µæ”¶è—ä½ å–œæ¬¢çš„å¥å­å§</text>
      <navigator url="/pages/index/index" class="goto-home-btn">
        <text>å»æ”¶è—</text>
      </navigator>
    </view>

    <!-- æ”¶è—åˆ—è¡¨ -->
    <view wx:else class="collection-list">
      <view wx:if="{{filteredCollections.length === 0 && searchValue}}" class="no-results">
        <text class="no-results-text">æ²¡æœ‰æ‰¾åˆ°ç›¸å…³æ”¶è—</text>
      </view>
      
      <view wx:else>
        <view 
          wx:for="{{filteredCollections}}" 
          wx:key="_id" 
          class="collection-item card fade-in"
        >
          <view 
            class="item-content"
            bindtap="onItemTap"
            data-index="{{index}}"
          >
            <view class="sentence-preview">
              <text class="english-preview">{{item.sentence.content || item.content}}</text>
              <text class="chinese-preview">{{item.sentence.translation || item.translation}}</text>
            </view>
            
            <view class="item-meta">
              <text class="collect-date">æ”¶è—äº {{item.collectedAt ? item.collectedAt.split('T')[0] : item.createTime.split('T')[0]}}</text>
            </view>
          </view>
          
          <view class="item-actions">
            <view 
              class="delete-btn" 
              bindtap="deleteItem" 
              data-index="{{index}}"
            >
              <text class="delete-icon">ğŸ—‘ï¸</text>
            </view>
          </view>
          
          <view class="item-arrow" bindtap="onItemTap" data-index="{{index}}">
            <text class="arrow-icon">â€º</text>
          </view>
        </view>
      </view>
    </view>

    <!-- ç»Ÿè®¡ä¿¡æ¯ -->
    <view wx:if="{{!loading && !isEmpty}}" class="stats-footer">
      <text class="stats-text">å…±æ”¶è—äº† {{collections.length}} æ¡å¥å­</text>
      <text class="refresh-hint">ğŸ’¡ ä¸‹æ‹‰å¯ä»¥åˆ·æ–°æ•°æ®</text>
    </view>
  </view>
</view>